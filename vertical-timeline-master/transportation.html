<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <script src="https://d3js.org/d3.v5.min.js"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script>document.getElementsByTagName("html")[0].className += " js";</script>
  <link rel="stylesheet" href="assets/css/style.css">


  <!-- <link rel="stylesheet" href="examples.css" type="text/css"> -->
  <script src='assets/js/index.js'></script>
	<script type="text/javascript" src="jquery.min.js"></script>
  <script type="text/javascript" src="ScrollMagic.js"></script>

  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  
	<!-- <script type="text/javascript" src="debug.addIndicators.js"></script> -->


</head>

<style>
  .container2 {
    position: relative;
    width: 100%;
    text-align: center;
    color: white;
  }

  .container2 img {
  /* -webkit-filter: grayscale(100%);
  filter: grayscale(50%); */
  filter: brightness(50%);;
}
  
  .centered {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 60px;
    font-style: oblique;
    font-weight: 900;
  }

  .populationBlock{
      width: 90%;
      height: 90%;
      display: flex;
      flex-flow: wrap;
  }

  .personIcon{
      height: 30%;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 120%;
      color: white;
      
  }

  .personContainer{
      height: 2.4vw;
      width: 2.4vw;
      margin: 0px;
  }
  </style>

  <style>
 
  text{
    font-size: 16px;
    font-family: Open Sans, sans-serif;
  }
  text.title{
    font-size: 24px;
    font-weight: 500;
  }
    text.subTitle{
      font-weight: 500;
      fill: #777777;
    }
    text.caption{
      font-weight: 400;
      font-size: 14px;
      fill: #777777;
    }
    text.label{
      font-weight: 600;
    }
  
    text.valueLabel{
     font-weight: 300;
    }
  
    text.yearText{
      font-size: 64px;
      font-weight: 700;
      opacity: 0.25;
    }
    .tick text {
      fill: #777777;
    }
    .xAxis .tick:nth-child(2) text {
      text-anchor: start;
    }
    .tick line {
      shape-rendering: CrispEdges;
      stroke: #dddddd;
    }
    .tick line.origin{
      stroke: #aaaaaa;
    }
    path.domain{
      display: none;
    }
</style>


<body>

    <header class="cd-main-header text-center flex flex-column flex-center" style="height: 50px; font-size: 10px;">
      <a href="intro.html"><i style='color:rgba(255, 255, 255, 0.35); font-size: 35px; position: absolute; top: 8px; left: 9px;' class="material-icons">
          home
      </i></a>

        <h1 style="color: rgba(255, 255, 255, 0.35); font-family: Arial, Helvetica, sans-serif; font-weight: 600; font-size: 20px;">PATH TO AUTONOMY</h1>
    </header>

  <div class="container2">
    <img src="images/transportationbanner.png">
    <div class="centered">Autonomous Driving</div>
  </div>


  
  <script>
    // Feel free to change or delete any of the code you see in this editor!
    var svg = d3.select("body").append("svg")
      .attr("width", 960)
      .attr("height", 600);
    
    
    
    var tickDuration = 500;
    
    var top_n = 12;
    var height = 600;
    var width = 960;
    
    const margin = {
      top: 80,
      right: 0,
      bottom: 5,
      left: 0
    };
  
    let barPadding = (height-(margin.bottom+margin.top))/(top_n*5);
      
    let title = svg.append('text')
     .attr('class', 'title')
     .attr('y', 24)
     .html('18 years of Interbrandâ€™s Top Global Brands');
  
    let subTitle = svg.append("text")
     .attr("class", "subTitle")
     .attr("y", 55)
     .html("Brand value, $m");
   
    let caption = svg.append('text')
     .attr('class', 'caption')
     .attr('x', width)
     .attr('y', height-5)
     .style('text-anchor', 'end')
     .html('Source: Interbrand');

     let year = 2000;
    
  d3.csv('driver_data.csv').then(function(data) {
    //if (error) throw error;
      
      console.log(data);
      
       data.forEach(d => {
        d.value = +d.value,
        d.lastValue = +d.lastValue,
        d.value = isNaN(d.value) ? 0 : d.value,
        d.year = +d.year,
        d.colour = d3.hsl(Math.random()*360,0.75,0.75)
      });

     console.log(data);
    
     let yearSlice = data.filter(d => d.year == year && !isNaN(d.value))
      .sort((a,b) => b.value - a.value)
      .slice(0, top_n);
  
      yearSlice.forEach((d,i) => d.rank = i);
    
     console.log('yearSlice: ', yearSlice)
  
     let x = d3.scaleLinear()
        .domain([0, d3.max(yearSlice, d => d.value)])
        .range([margin.left, width-margin.right-65]);
  
     let y = d3.scaleLinear()
        .domain([top_n, 0])
        .range([height-margin.bottom, margin.top]);
  
     let xAxis = d3.axisTop()
        .scale(x)
        .ticks(width > 500 ? 5:2)
        .tickSize(-(height-margin.top-margin.bottom))
        .tickFormat(d => d3.format(',')(d));
  
     svg.append('g')
       .attr('class', 'axis xAxis')
       .attr('transform', `translate(0, ${margin.top})`)
       .call(xAxis)
       .selectAll('.tick line')
       .classed('origin', d => d == 0);
  
     svg.selectAll('rect.bar')
        .data(yearSlice, d => d.name)
        .enter()
        .append('rect')
        .attr('class', 'bar')
        .attr('x', x(0)+1)
        .attr('width', d => x(d.value)-x(0)-1)
        .attr('y', d => y(d.rank)+5)
        .attr('height', y(1)-y(0)-barPadding)
        .style('fill', d => d.colour);
      
     svg.selectAll('text.label')
        .data(yearSlice, d => d.name)
        .enter()
        .append('text')
        .attr('class', 'label')
        .attr('x', d => x(d.value)-8)
        .attr('y', d => y(d.rank)+5+((y(1)-y(0))/2)+1)
        .style('text-anchor', 'end')
        .html(d => d.name);
      
    svg.selectAll('text.valueLabel')
      .data(yearSlice, d => d.name)
      .enter()
      .append('text')
      .attr('class', 'valueLabel')
      .attr('x', d => x(d.value)+5)
      .attr('y', d => y(d.rank)+5+((y(1)-y(0))/2)+1)
      .text(d => d3.format(',.0f')(d.lastValue));

    let yearText = svg.append('text')
      .attr('class', 'yearText')
      .attr('x', width-margin.right)
      .attr('y', height-25)
      .style('text-anchor', 'end')
      .html(~~year)
      .call(halo, 10);
     
   let ticker = d3.interval(e => {

      yearSlice = data.filter(d => d.year == year && !isNaN(d.value))
        .sort((a,b) => b.value - a.value)
        .slice(0,top_n);

      yearSlice.forEach((d,i) => d.rank = i);
     
      //console.log('IntervalYear: ', yearSlice);

      x.domain([0, d3.max(yearSlice, d => d.value)]); 
     
      svg.select('.xAxis')
        .transition()
        .duration(tickDuration)
        .ease(d3.easeLinear)
        .call(xAxis);
    
       let bars = svg.selectAll('.bar').data(yearSlice, d => d.name);
    
       bars
        .enter()
        .append('rect')
        .attr('class', d => `bar ${d.name.replace(/\s/g,'_')}`)
        .attr('x', x(0)+1)
        .attr( 'width', d => x(d.value)-x(0)-1)
        .attr('y', d => y(top_n+1)+5)
        .attr('height', y(1)-y(0)-barPadding)
        .style('fill', d => d.colour)
        .transition()
          .duration(tickDuration)
          .ease(d3.easeLinear)
          .attr('y', d => y(d.rank)+5);
          
       bars
        .transition()
          .duration(tickDuration)
          .ease(d3.easeLinear)
          .attr('width', d => x(d.value)-x(0)-1)
          .attr('y', d => y(d.rank)+5);
            
       bars
        .exit()
        .transition()
          .duration(tickDuration)
          .ease(d3.easeLinear)
          .attr('width', d => x(d.value)-x(0)-1)
          .attr('y', d => y(top_n+1)+5)
          .remove();

       let labels = svg.selectAll('.label')
          .data(yearSlice, d => d.name);
     
       labels
        .enter()
        .append('text')
        .attr('class', 'label')
        .attr('x', d => x(d.value)-8)
        .attr('y', d => y(top_n+1)+5+((y(1)-y(0))/2))
        .style('text-anchor', 'end')
        .html(d => d.name)    
        .transition()
          .duration(tickDuration)
          .ease(d3.easeLinear)
          .attr('y', d => y(d.rank)+5+((y(1)-y(0))/2)+1);
             
    
   	   labels
          .transition()
          .duration(tickDuration)
            .ease(d3.easeLinear)
            .attr('x', d => x(d.value)-8)
            .attr('y', d => y(d.rank)+5+((y(1)-y(0))/2)+1);
     
       labels
          .exit()
          .transition()
            .duration(tickDuration)
            .ease(d3.easeLinear)
            .attr('x', d => x(d.value)-8)
            .attr('y', d => y(top_n+1)+5)
            .remove();
         

     
       let valueLabels = svg.selectAll('.valueLabel').data(yearSlice, d => d.name);
    
       valueLabels
          .enter()
          .append('text')
          .attr('class', 'valueLabel')
          .attr('x', d => x(d.value)+5)
          .attr('y', d => y(top_n+1)+5)
          .text(d => d3.format(',.0f')(d.lastValue))
          .transition()
            .duration(tickDuration)
            .ease(d3.easeLinear)
            .attr('y', d => y(d.rank)+5+((y(1)-y(0))/2)+1);
            
       valueLabels
          .transition()
            .duration(tickDuration)
            .ease(d3.easeLinear)
            .attr('x', d => x(d.value)+5)
            .attr('y', d => y(d.rank)+5+((y(1)-y(0))/2)+1)
            .tween("text", function(d) {
               let i = d3.interpolateRound(d.lastValue, d.value);
               return function(t) {
                 this.textContent = d3.format(',')(i(t));
              };
            });
      
     
      valueLabels
        .exit()
        .transition()
          .duration(tickDuration)
          .ease(d3.easeLinear)
          .attr('x', d => x(d.value)+5)
          .attr('y', d => y(top_n+1)+5)
          .remove();
    
      yearText.html(~~year);
     
     if(year == 2018) ticker.stop();
     year = d3.format('.1f')((+year) + 0.1);
   },tickDuration);

 });
    
 const halo = function(text, strokeWidth) {
  text.select(function() { return this.parentNode.insertBefore(this.cloneNode(true), this); })
    .style('fill', '#ffffff')
     .style( 'stroke','#ffffff')
     .style('stroke-width', strokeWidth)
     .style('stroke-linejoin', 'round')
     .style('opacity', 1);
   
}   
  

  </script>






  <div style="float: left; width:70%;">
  <section class="cd-timeline js-cd-timeline">
    <div class="container max-width-lg cd-timeline__container">
      <div class="cd-timeline__block">
        <div class="cd-timeline__img cd-timeline__img--picture">
          <img src="assets/img/cd-icon-picture.svg" alt="Picture">
        </div> <!-- cd-timeline__img -->

        <div class="cd-timeline__content text-component">
            <div class="flex justify-between items-center">
              <span class="cd-timeline__date">Apr 2019</span>
            </div>
          <h2>Level 4 Automation Achieved!</h2>
          <p class="color-contrast-medium">
              Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
          </p>
          <img src="images/waymo.png">
          
        </div> <!-- cd-timeline__content -->
      </div> <!-- cd-timeline__block -->

      <div class="cd-timeline__block">
        <div class="cd-timeline__img cd-timeline__img--movie">
          <img src="assets/img/cd-icon-movie.svg" alt="Movie">
        </div> <!-- cd-timeline__img -->

        <div class="cd-timeline__content text-component">
          <div class="flex justify-between items-center">
            <span class="cd-timeline__date">Dec 2020</span>
          </div>
          <h2>Shrinking Demand for Truck Drivers: 60k Drivers Out Of Work</h2>
          <p class="color-contrast-medium">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Iusto, optio, dolorum provident rerum aut hic quasi placeat iure tempora laudantium ipsa ad debitis unde?</p>
          <img src="images/onedriver.jpg">


          
          
        </div> <!-- cd-timeline__content -->
      </div> <!-- cd-timeline__block -->

      <div class="cd-timeline__block">
          <div class="cd-timeline__img cd-timeline__img--location">
            <img src="assets/img/cd-icon-location.svg" alt="Location">
          </div> <!-- cd-timeline__img -->
  
          <div class="cd-timeline__content text-component">
            <div class="flex justify-between items-center">
              <span class="cd-timeline__date">Apr 2021</span>
            </div>
            <h2>Trucking Goes Fully Autonomous</h2>
            <p class="color-contrast-medium">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Iusto, optio, dolorum provident rerum.</p>
            <img src="images/autonomoustruck.jpg">
          </div> <!-- cd-timeline__content -->
        </div> <!-- cd-timeline__block -->

      <div class="cd-timeline__block">
        <div class="cd-timeline__img cd-timeline__img--picture">
          <img src="assets/img/cd-icon-picture.svg" alt="Picture">
        </div> <!-- cd-timeline__img -->

        <div class="cd-timeline__content text-component">
          <div class="flex justify-between items-center">
            <span class="cd-timeline__date">Mar 2021</span>
          </div>
          <h2>Uber launches Level 5 Autonomous Vehicle Ride Service</h2>
          <p class="color-contrast-medium">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Excepturi, obcaecati, quisquam id molestias eaque asperiores voluptatibus cupiditate error assumenda delectus odit similique earum voluptatem doloremque dolorem ipsam quae rerum quis.</p>
          <img src="images/driverlessuber.jpg">
          
        </div> <!-- cd-timeline__content -->
      </div> <!-- cd-timeline__block -->

      <div class="cd-timeline__block">
        <div class="cd-timeline__img cd-timeline__img--location">
          <img src="assets/img/cd-icon-location.svg" alt="Location">
        </div> <!-- cd-timeline__img -->

        <div class="cd-timeline__content text-component">
          <div class="flex justify-between items-center">
            <span class="cd-timeline__date">Nov 2022</span>
          </div>
          <h2>Level 5 Autonomous Vehicles For Consumers Finally Debut</h2>
          <p class="color-contrast-medium">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Iusto, optio, dolorum provident rerum aut hic quasi placeat iure tempora laudantium ipsa ad debitis unde? Iste voluptatibus minus veritatis qui ut.</p>
          <img src="images/fulllyautonomous.jpg">
          
        </div> <!-- cd-timeline__content -->
      </div> <!-- cd-timeline__block -->

      

      <div class="cd-timeline__block">
        <div class="cd-timeline__img cd-timeline__img--movie">
          <img src="assets/img/cd-icon-movie.svg" alt="Movie">
        </div> <!-- cd-timeline__img -->

        <div class="cd-timeline__content text-component">
          <div class="flex justify-between items-center">
            <span class="cd-timeline__date">Aug 2023</span>
          </div>
          <h2>California Prohibits Passenger Driving On HighWays</h2>
          <p class="color-contrast-medium">This is the content of the last section</p>

        </div> <!-- cd-timeline__content -->
      </div> <!-- cd-timeline__block -->
    </div>
    <a href="intro.html" class="btn btn--subtle" style="margin-top: 5%; margin-left: 39%;">Choose Different Industry</a>

  </section> <!-- cd-timeline -->
  </div>




<!--  -->
  <div style="float: left; width:30%; outline: white solid 3px;">

    <div style="margin-left: 2%; margin-right: 2%; background-color: #E8EFF5">
        <section id="titlechart">
            <div id="description">
            </div>
            <script>
              // init controller
              var controller = new ScrollMagic.Controller();
            </script>
          </section>
          <section class="demo">
              
            <div class="spacer s2" style="height: 309px;"></div>
            <div id="trigger1" class="spacer s0"></div>
            <div id="pin1" style="padding-bottom: 50px; margin-top: -309px;">

            <h4 style="text-align: center; margin-top: 20px;">100 Persons Scale</h4>
            <h5 style="text-align: center; font-style: italic;"><span style="color: green;">employed</span> vs. <span style="color: red;">unemployed</span></h5>
              <figure id='mainPopulationBlock' style="">
                <div id='populationBlock' class='populationBlock' style="margin: 5%; outline: black solid 1px; padding-top: 15px; padding-left: 10px;">
                  <img src="fakeppl.png" style="width:95%; margin-top: -10px;">
                </div>
            </figure>
                
                <!-- <img id="sonny" src="images/image1.jpg" style="height: 300px; width: 100%; border: 3px solid #E8EFF5; border-radius: 30px;" > -->
                <p id="sonnytxt" style="margin: 5%; font-size: 17px;">text</p>
            </div>
            <script>
              $(function () { // wait for document ready
                // build scene
                var scene = new ScrollMagic.Scene({triggerElement: "#trigger1", duration: 3988})
                        .setPin("#pin1")
                        .addIndicators({name: "1 (duration: 300)"}) // add indicators (requires plugin)
                        .addTo(controller);
              });
            </script>
          </section>

    </div>
  </div>

  <script id='personIconBefore' type='"text/x-lodash-template'>
      <div  class='personContainer'>
          <i style='color:green' class="material-icons personIcon">
                  accessibility_new
          </i>
      </div>
  </script>

  <script id='personIconAfter' type='"text/x-lodash-template'>
      <div  class='personContainer'>
          <i style='color:red' class="material-icons personIcon">
                  accessibility_new
          </i>
      </div>
  </script>



  <script src="assets/js/main.js"></script>

</body>
</html>